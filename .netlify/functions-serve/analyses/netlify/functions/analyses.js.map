{
  "version": 3,
  "sources": ["../../../../../../SITES/bombeiro_pe/sgvp-cbmpe-v2/netlify/functions/analyses.js"],
  "sourceRoot": "C:/Users/brunn/AppData/Local/Temp/tmp-20500-R5izrrhtHU0D",
  "sourcesContent": ["// Netlify Function - API para DynamoDB\r\nimport { DynamoDBClient } from '@aws-sdk/client-dynamodb';\r\nimport { \r\n  DynamoDBDocumentClient, \r\n  PutCommand, \r\n  GetCommand, \r\n  ScanCommand, \r\n  DeleteCommand,\r\n  QueryCommand \r\n} from '@aws-sdk/lib-dynamodb';\r\n\r\n// Configurar cliente DynamoDB\r\nconsole.log('\uD83D\uDD27 Configurando DynamoDB...');\r\nconsole.log('Region:', process.env.MY_AWS_REGION || process.env.AWS_REGION || 'us-east-1');\r\nconsole.log('Access Key exists:', !!process.env.MY_AWS_ACCESS_KEY_ID || !!process.env.AWS_ACCESS_KEY_ID);\r\n\r\nconst client = new DynamoDBClient({\r\n  region: process.env.MY_AWS_REGION || process.env.AWS_REGION || 'us-east-1',\r\n  credentials: {\r\n    accessKeyId: process.env.MY_AWS_ACCESS_KEY_ID || process.env.AWS_ACCESS_KEY_ID,\r\n    secretAccessKey: process.env.MY_AWS_SECRET_ACCESS_KEY || process.env.AWS_SECRET_ACCESS_KEY,\r\n  },\r\n});\r\n\r\nconst docClient = DynamoDBDocumentClient.from(client);\r\n\r\n// Fun\u00E7\u00E3o para detectar a tabela baseado no path ou query param\r\nconst getTableFromPath = (path, queryParams) => {\r\n  // Priorizar query param 'table'\r\n  if (queryParams?.table) return queryParams.table;\r\n  \r\n  if (path.includes('/processes')) return 'processes';\r\n  if (path.includes('/history')) return 'process_history';\r\n  if (path.includes('/documents')) return 'process_documents';\r\n  if (path.includes('/profiles')) return 'profiles';\r\n  if (path.includes('/roles')) return 'user_roles';\r\n  return 'analyses'; // default\r\n};\r\n\r\n// Headers CORS\r\nconst headers = {\r\n  'Access-Control-Allow-Origin': '*',\r\n  'Access-Control-Allow-Headers': 'Content-Type',\r\n  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\r\n  'Content-Type': 'application/json',\r\n};\r\n\r\nexport const handler = async (event) => {\r\n  console.log('\uD83D\uDE80 NEW VERSION - Function called:', event.httpMethod, event.path);\r\n  console.log('\uD83D\uDE80 Query params:', JSON.stringify(event.queryStringParameters));\r\n  \r\n  // Handle CORS preflight\r\n  if (event.httpMethod === 'OPTIONS') {\r\n    return { statusCode: 200, headers, body: '' };\r\n  }\r\n\r\n  try {\r\n    console.log('\uD83D\uDD0D DEBUG: Entering try block');\r\n    const queryParams = event.queryStringParameters || {};\r\n    console.log('\uD83D\uDD0D DEBUG: Query params:', JSON.stringify(queryParams));\r\n    \r\n    // Detectar tabela baseado no path original ou query param\r\n    const TABLE_NAME = getTableFromPath(event.path, queryParams);\r\n    console.log('\uD83D\uDCCA Using table:', TABLE_NAME);\r\n    \r\n    // Limpar o path\r\n    let path = event.path\r\n      .replace('/.netlify/functions/analyses', '')\r\n      .replace('/.netlify/functions/processes', '')\r\n      .replace('/.netlify/functions/history', '')\r\n      .replace('/.netlify/functions/documents', '')\r\n      .replace('/.netlify/functions/profiles', '')\r\n      .replace('/.netlify/functions/roles', '')\r\n      .replace('/api/analyses', '')\r\n      .replace('/api/processes', '')\r\n      .replace('/api/history', '')\r\n      .replace('/api/documents', '')\r\n      .replace('/api/profiles', '')\r\n      .replace('/api/roles', '');\r\n    const method = event.httpMethod;\r\n\r\n    // GET - Listar todas ou buscar por ID/filtros\r\n    if (method === 'GET' && path === '') {\r\n      // Se tiver ID na query string, buscar por ID\r\n      if (queryParams.id) {\r\n        if (TABLE_NAME === 'profiles') {\r\n          console.log('\uD83D\uDC64 === BUSCANDO PERFIL POR ID ===');\r\n          console.log('User ID:', queryParams.id);\r\n        }\r\n        \r\n        const command = new GetCommand({\r\n          TableName: TABLE_NAME,\r\n          Key: { id: queryParams.id },\r\n        });\r\n        \r\n        const result = await docClient.send(command);\r\n        \r\n        if (!result.Item) {\r\n          if (TABLE_NAME === 'profiles') {\r\n            console.log('\uD83D\uDC64 Perfil n\u00E3o encontrado para ID:', queryParams.id);\r\n          }\r\n          return {\r\n            statusCode: 404,\r\n            headers,\r\n            body: JSON.stringify({ error: 'Item n\u00E3o encontrado' }),\r\n          };\r\n        }\r\n        \r\n        if (TABLE_NAME === 'profiles') {\r\n          console.log('\uD83D\uDC64 Perfil encontrado:', JSON.stringify(result.Item, null, 2));\r\n        }\r\n        \r\n        return {\r\n          statusCode: 200,\r\n          headers,\r\n          body: JSON.stringify(result.Item),\r\n        };\r\n      }\r\n      \r\n      // Scan com filtros opcionais\r\n      let scanParams = { TableName: TABLE_NAME };\r\n      \r\n      if (queryParams.user_id) {\r\n        scanParams.FilterExpression = 'user_id = :user_id';\r\n        scanParams.ExpressionAttributeValues = { ':user_id': queryParams.user_id };\r\n      } else if (queryParams.process_id) {\r\n        scanParams.FilterExpression = 'process_id = :process_id';\r\n        scanParams.ExpressionAttributeValues = { ':process_id': queryParams.process_id };\r\n      }\r\n      \r\n      const command = new ScanCommand(scanParams);\r\n      \r\n      const result = await docClient.send(command);\r\n      \r\n      return {\r\n        statusCode: 200,\r\n        headers,\r\n        body: JSON.stringify(result.Items || []),\r\n      };\r\n    }\r\n\r\n    // GET /api/analyses/stats - Estat\u00EDsticas\r\n    if (method === 'GET' && path === '/stats') {\r\n      const command = new ScanCommand({\r\n        TableName: TABLE_NAME,\r\n      });\r\n      \r\n      const result = await docClient.send(command);\r\n      const analyses = result.Items || [];\r\n      \r\n      const stats = {\r\n        total: analyses.length,\r\n        aprovados: analyses.filter(a => a.status === 'aprovado').length,\r\n        pendentes: analyses.filter(a => a.status === 'pendente').length,\r\n        reprovados: analyses.filter(a => a.status === 'reprovado').length,\r\n        porRisco: {\r\n          baixo: analyses.filter(a => a.analise?.riskLevel === 'low').length,\r\n          medio: analyses.filter(a => a.analise?.riskLevel === 'medium').length,\r\n          alto: analyses.filter(a => a.analise?.riskLevel === 'high').length,\r\n        },\r\n        porTipo: {\r\n          DDLCB: analyses.filter(a => a.certificado?.tipo === 'DDLCB').length,\r\n          AR: analyses.filter(a => a.certificado?.tipo === 'AR').length,\r\n          AVCB: analyses.filter(a => a.certificado?.tipo === 'AVCB').length,\r\n        },\r\n      };\r\n      \r\n      return {\r\n        statusCode: 200,\r\n        headers,\r\n        body: JSON.stringify(stats),\r\n      };\r\n    }\r\n\r\n    // GET /api/analyses/:id - Buscar por ID\r\n    if (method === 'GET' && path.startsWith('/')) {\r\n      const id = path.substring(1);\r\n      \r\n      const command = new GetCommand({\r\n        TableName: TABLE_NAME,\r\n        Key: { id },\r\n      });\r\n      \r\n      const result = await docClient.send(command);\r\n      \r\n      if (!result.Item) {\r\n        return {\r\n          statusCode: 404,\r\n          headers,\r\n          body: JSON.stringify({ error: 'An\u00E1lise n\u00E3o encontrada' }),\r\n        };\r\n      }\r\n      \r\n      return {\r\n        statusCode: 200,\r\n        headers,\r\n        body: JSON.stringify(result.Item),\r\n      };\r\n    }\r\n\r\n    // POST /api/analyses - Criar nova an\u00E1lise\r\n    if (method === 'POST') {\r\n      console.log('\uD83D\uDCBE Salvando item na tabela:', TABLE_NAME);\r\n      const data = JSON.parse(event.body);\r\n      \r\n      // Log espec\u00EDfico para cria\u00E7\u00E3o de perfil\r\n      if (TABLE_NAME === 'profiles') {\r\n        console.log('\uD83D\uDC64 === CRIANDO PERFIL DE USU\u00C1RIO ===');\r\n        console.log('Dados recebidos:', JSON.stringify(data, null, 2));\r\n      }\r\n      \r\n      // Gerar ID se n\u00E3o existir\r\n      if (!data.id) {\r\n        data.id = `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n      }\r\n      \r\n      // Adicionar timestamps baseado na tabela\r\n      if (TABLE_NAME === 'analyses') {\r\n        data.createdAt = new Date().toISOString();\r\n      } else {\r\n        if (!data.created_at) {\r\n          data.created_at = new Date().toISOString();\r\n        }\r\n        if (!data.updated_at && TABLE_NAME === 'processes') {\r\n          data.updated_at = new Date().toISOString();\r\n        }\r\n        if (!data.uploaded_at && TABLE_NAME === 'process_documents') {\r\n          data.uploaded_at = new Date().toISOString();\r\n          data.updated_at = new Date().toISOString();\r\n        }\r\n      }\r\n      \r\n      console.log('\uD83D\uDCDD Dados finais:', { id: data.id, table: TABLE_NAME });\r\n      \r\n      if (TABLE_NAME === 'profiles') {\r\n        console.log('\uD83D\uDC64 Dados do perfil a serem salvos:', JSON.stringify(data, null, 2));\r\n      }\r\n      \r\n      const command = new PutCommand({\r\n        TableName: TABLE_NAME,\r\n        Item: data,\r\n      });\r\n      \r\n      console.log('\uD83D\uDE80 Enviando para DynamoDB...');\r\n      await docClient.send(command);\r\n      console.log('\u2705 Salvo com sucesso!');\r\n      \r\n      if (TABLE_NAME === 'profiles') {\r\n        console.log('\uD83D\uDC64 === PERFIL CRIADO COM SUCESSO ===');\r\n      }\r\n      \r\n      return {\r\n        statusCode: 201,\r\n        headers,\r\n        body: JSON.stringify({ \r\n          id: data.id, \r\n          message: TABLE_NAME === 'profiles' ? 'Perfil criado com sucesso' : 'An\u00E1lise criada com sucesso' \r\n        }),\r\n      };\r\n    }\r\n\r\n    // PUT /api/analyses - Atualizar an\u00E1lise\r\n    if (method === 'PUT') {\r\n      console.log('\uD83D\uDD04 Atualizando item...');\r\n      const data = JSON.parse(event.body);\r\n      \r\n      if (!data.id) {\r\n        return {\r\n          statusCode: 400,\r\n          headers,\r\n          body: JSON.stringify({ error: 'ID \u00E9 obrigat\u00F3rio para atualiza\u00E7\u00E3o' }),\r\n        };\r\n      }\r\n      \r\n      // Buscar item existente primeiro\r\n      console.log('\uD83D\uDCD6 Buscando item existente...');\r\n      const getCommand = new GetCommand({\r\n        TableName: TABLE_NAME,\r\n        Key: { id: data.id },\r\n      });\r\n      \r\n      const existingItem = await docClient.send(getCommand);\r\n      \r\n      if (!existingItem.Item) {\r\n        return {\r\n          statusCode: 404,\r\n          headers,\r\n          body: JSON.stringify({ error: 'Item n\u00E3o encontrado' }),\r\n        };\r\n      }\r\n      \r\n      // Mesclar dados existentes com novos dados\r\n      const mergedData = {\r\n        ...existingItem.Item,\r\n        ...data,\r\n      };\r\n      \r\n      // Atualizar timestamp\r\n      if (TABLE_NAME === 'processes' || TABLE_NAME === 'process_documents') {\r\n        mergedData.updated_at = new Date().toISOString();\r\n      }\r\n      \r\n      console.log('\uD83D\uDCDD Atualizando:', { id: mergedData.id, table: TABLE_NAME });\r\n      \r\n      const command = new PutCommand({\r\n        TableName: TABLE_NAME,\r\n        Item: mergedData,\r\n      });\r\n      \r\n      console.log('\uD83D\uDE80 Enviando atualiza\u00E7\u00E3o para DynamoDB...');\r\n      await docClient.send(command);\r\n      console.log('\u2705 Atualizado com sucesso!');\r\n      \r\n      return {\r\n        statusCode: 200,\r\n        headers,\r\n        body: JSON.stringify({ \r\n          id: data.id, \r\n          message: 'Item atualizado com sucesso' \r\n        }),\r\n      };\r\n    }\r\n\r\n    // DELETE - Deletar item\r\n    if (method === 'DELETE') {\r\n      let itemId;\r\n      \r\n      // Tentar pegar ID da URL ou do body\r\n      if (path.startsWith('/') && path.length > 1) {\r\n        itemId = path.substring(1);\r\n      } else {\r\n        // Tentar pegar do body\r\n        const data = JSON.parse(event.body || '{}');\r\n        itemId = data.id;\r\n      }\r\n      \r\n      if (!itemId) {\r\n        return {\r\n          statusCode: 400,\r\n          headers,\r\n          body: JSON.stringify({ error: 'ID \u00E9 obrigat\u00F3rio para exclus\u00E3o' }),\r\n        };\r\n      }\r\n      \r\n      console.log('\uD83D\uDDD1\uFE0F Deletando item:', itemId, 'da tabela:', TABLE_NAME);\r\n      \r\n      const command = new DeleteCommand({\r\n        TableName: TABLE_NAME,\r\n        Key: { id: itemId },\r\n      });\r\n      \r\n      await docClient.send(command);\r\n      console.log('\u2705 Item deletado com sucesso!');\r\n      \r\n      return {\r\n        statusCode: 200,\r\n        headers,\r\n        body: JSON.stringify({ message: `${TABLE_NAME === 'process_documents' ? 'Documento' : 'Item'} deletado com sucesso` }),\r\n      };\r\n    }\r\n\r\n    // Rota n\u00E3o encontrada\r\n    return {\r\n      statusCode: 404,\r\n      headers,\r\n      body: JSON.stringify({ error: 'Rota n\u00E3o encontrada' }),\r\n    };\r\n\r\n  } catch (error) {\r\n    console.error('\u274C Erro:', error);\r\n    console.error('Stack:', error.stack);\r\n    \r\n    return {\r\n      statusCode: 500,\r\n      headers,\r\n      body: JSON.stringify({ \r\n        error: 'Erro interno do servidor',\r\n        message: error.message,\r\n        details: process.env.NODE_ENV === 'development' ? error.stack : undefined\r\n      }),\r\n    };\r\n  }\r\n};\r\n"],
  "mappings": "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",
  "names": ["command", "result"]
}
